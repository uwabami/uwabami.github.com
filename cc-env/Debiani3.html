<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>i3 の設定</title>
<meta name="description" content="My Interest: Fluid Dynamics, Convection, MHD Dynamo, Numerical Computing, Unix, Linux, Debian">
<link rel="stylesheet" href="/css/main.css" >
<link rel="canonical" href="/cc-env/Debiani3.html">

<link rel="alternate" hreflang="ja" href="/cc-env/Debiani3.html" />
<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
    <script src="/assets/js/html5shiv.min.js"></script>
    <script src="/assets/js/respond.min.js"></script>
<![endif]-->
<link rel="icon" type="image/x-icon" href="/favicon.ico">

    <link rel="stylesheet" href="/css/cc-env.css" >
  </head>
  <body>
    <span id="page-top"></span>
    <!-- Fixed navbar -->
<nav class="navbar navbar-default navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/index.html">Youhei SASAKI's official site</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
        
        <li><a class="page-link" href="/research/index.html">Research</a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Software<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="/software/index.html">Repository</a></li>
            <li><a href="/cc-env/index.html">Computer Memo</a></li>
          </ul>
        </li>
        <li><a class="page-link" href="https://uwabami.junkhub.org/log">Blog</a></li>
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
        
          
        
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</nav>

    <div class="container">
      <div class="content">
        <div class="row">
          <div class="page-header col-xs-12">
            
            <h1>i3 の設定</h1>
            
            <ul class="breadcrumb">
  
  <li><a href="/index.html">Top</a></li>
  
  
    
    
      
  <li><a href="/cc-env/index.html">Cc-env</a></li>
      
    
  
    
    
  
</ul>

          </div>
          <div class="col-xs-12">
            <p>Related <a href="wiki:index">Index</a> <a href="id:591f6b0d-55ff-48eb-b095-401cdfa0d536">Debian</a></p>
<h2><a id="始めに"><span class='anchor'>_</span></a>始めに</h2>
<p>スペックがあまり潤沢ではない機材を使うため,
  軽量な wm として <a href="https://i3wm.org/">i3 - improved tiling wm</a> を使い始めた.</p>
<p>元々常に tmux を全画面にして作業しているわけで
  タイル型である恩恵を受けられるのか, という疑問はあったのだが,
  使ってみたら「綺麗」かつ「驚きの軽さ」ということで, すっかり気にいってしまった.</p>
<h2><a id="i3 と一緒に使っているもの"><span class='anchor'>_</span></a>i3 と一緒に使っているもの</h2>
<p>とりあえず現状では以下:</p>
<ul>
  <li>ターミナル関連: urxvt と tmux → <a href="wiki:Terminal.html">Terminal生活</a></li>
  <li>ファイルマネージャ: ranger</li>
  <li>ブラウザ: firefox + vimfx</li>
  <li>外付けドライブの管理: udiskie</li>
  <li>ランチャ: rofi</li>
</ul>
<p>他にも</p>
<ul>
  <li>Compositor: compton</li>
  <li>ネットワーク: Network Manager</li>
  <li>Bluetooth: blueman</li>
  <li>音: pulseaudio</li>
</ul>
<p>といった所はそのまま, かな?</p>
<ul>
  <li>これから試す/探しているモノ [0/2]
    <ul>
      <li>[ ] <a href="https://01.org/connman">ConnMan | 01.org</a> も試してみたいが, どうだろう.</li>
      <li>[ ] pulseaudio の CUI なミキサーって良い奴無いかなぁ&#8230;</li>
    </ul>
  </li>
</ul>
<h2><a id="i3 の設定"><span class='anchor'>_</span></a>i3 の設定</h2>
<p>設定ファイルは末尾に掲載している.</p>
<h3><a id="xdg-open と run-mailcap"><span class='anchor'>_</span></a>xdg-open と run-mailcap</h3>
<p>いわゆる GNOME や KDE といった Desktop 環境ではないので,
  たとえば <code>xdg-open</code> の挙動が変わります.
  それ自体は問題無いのですが, <code>~/.mailcap</code> の設定次第では
  <code>run-mailcap</code> が <code>xdg-open</code> を呼び, <code>xdg-open</code> が <code>run-mailcap</code> を呼び, といった
  無限ループが発生します.
  <del>run-mailcapを抜けば良い, という話もありますが, これ=mime-support=パッケージで提供されているので, 抜くとpython が抜けて大変な目に会います</del></p>
<p>というわけで, 安直には <code>xdg-open</code> を修正すれば良いですね:</p>
<div class="highlight"><pre><span></span><span class="gd">--- /usr/bin/xdg-open.orig	2015-10-06 04:19:48.000000000 +0900</span>
<span class="gi">+++ /usr/bin/xdg-open	2017-07-24 21:18:32.191564009 +0900</span>
<span class="gu">@@ -787,20 +787,9 @@</span>
         if [ -n &quot;$DISPLAY&quot; ]; then
             filetype=`xdg-mime query filetype &quot;$file&quot; | sed &quot;s/;.*//&quot;`
             open_generic_xdg_mime &quot;$file&quot; &quot;$filetype&quot;
<span class="gd">-        fi</span>
<span class="gd">-</span>
<span class="gd">-        if which run-mailcap 2&gt;/dev/null 1&gt;&amp;2; then</span>
<span class="gd">-            run-mailcap --action=view &quot;$file&quot;</span>
<span class="gd">-            if [ $? -eq 0 ]; then</span>
<span class="gd">-                exit_success</span>
<span class="gd">-            fi</span>
<span class="gd">-        fi</span>
<span class="gd">-</span>
<span class="gd">-        if [ -n &quot;$DISPLAY&quot; ] &amp;&amp; mimeopen -v 2&gt;/dev/null 1&gt;&amp;2; then</span>
<span class="gd">-            mimeopen -L -n &quot;$file&quot;</span>
<span class="gd">-            if [ $? -eq 0 ]; then</span>
<span class="gd">-                exit_success</span>
<span class="gd">-            fi</span>
<span class="gi">+        else</span>
<span class="gi">+            echo &quot;can&#39;t handle: please set mime type via xdg-mime&quot;</span>
<span class="gi">+            exit_failure_operation_failed</span>
         fi
     fi
</pre></div>
<p>あと, <code>~/.local/share/applications/mimeapps.list</code> から <code>~/.config/mimeapps.list</code> へ
  symbolic link を作成しておきます.</p>
<h3><a id="Alt+Tab でのフォーカスの切り替え"><span class='anchor'>_</span></a>Alt+Tab でのフォーカスの切り替え</h3>
<p><code>i3-msg -t get_tree</code> で状態が json で出力されるので,
  これを parse して良きに図らえば良い.</p>
<p>幾つか候補はあるけれど, 依存が少なくシンプルだったので
  <a href="https://github.com/westurner/i3t">westurner/i3t: i3t</a> をありがたく使わせて頂くことに.</p>
<p>設定は</p>
<div class="highlight"><pre><span></span>set $i3t_alt_tab ~/.config/i3/i3t.py n
bindsym $Alt+Tab exec $i3t_alt_tab
</pre></div>
<p>みたいな感じで良い.</p>
<h3><a id="Rofi: ランチャ"><span class='anchor'>_</span></a>Rofi: ランチャ</h3>
<p><a href="https://davedavenport.github.io/rofi/">Rofi</a> は良い感じのランチャ.
  公式 Web の <code>This site is currently looking for a maintainer.</code> が怖いけれど.</p>
<p>設定ファイルは <code>~/.config/rofi/config</code> か <code>~/.Xresources</code> で行なう.
  今はこんな塩梅:</p>
<p>i3の方では Alt+F2, Alt+Shift+Tab で呼び出せるようにしている:</p>
<div class="highlight"><pre><span></span>bindsym $Alt+F2 $execi sh -c &quot;rofi -show combi&quot;
bindsym $Alt+Shift+Tab $execi sh -c &quot;rofi -show window&quot;
</pre></div>
<h3><a id="i3bar"><span class='anchor'>_</span></a>i3bar</h3>
<p>conky で情報を更新/整形して出力している.
  conky の設定は以下: <code>~/.config/i3/i3bar-conkyrc</code></p>
<p>呼び出しは <code>run-conky.sh</code> で:</p>
<p>status ラインは以下の通り</p>
<div class="highlight"><pre><span></span># status bar
bar &#123;
    position    top
    tray_output primary
    tray_padding -2
    font xft:FontAwesome,RictyDiminished 11.5
    status_command $HOME/.config/i3/i3bar-conky.sh
    colors &#123;
      background #111822
      statusline #F6F3E8
      separator  #111822
      focused_workspace  #111822 #222244 #F6F3E8
      active_workspace   #555555 #555555 #F6F3E8
      inactive_workspace #020202 #242424 #888888
      urgent_workspace   #A00000 #900000 #F6F3E8
      binding_mode       #A00000 #900000 #f6f3e8
    }
}
</pre></div>
<h3><a id="screen lock: i3lock の設定"><span class='anchor'>_</span></a>screen lock: i3lock の設定</h3>
<p>suspend → resume した時に i3lock を走らせたいので
  <code>/etc/systemd/system/i3lock.service</code>:</p>
<p>を作成して有効にしておく.
  本当は <code>~/.config/systemd/user</code> で設定したいのだけれど,
  権限が無いのか上手くいかない. polkit を適宜設定すれば良いのかもしれないけれど.</p>
<h2><a id="i3 の設定ファイル"><span class='anchor'>_</span></a>i3 の設定ファイル</h2>
<p>設定ファイル全体は以下の通り</p>


          </div>
          <a href="#page-top" class="pagetop btn top-btn">Top</a>
        </div> <!-- /.row -->
      </div> <!-- /.content -->
    </div> <!-- /.container -->
    <footer class="footer">
  <div class="container">
    <div class="row">
      <div class="col-sm-12 col-xs-12">
        <p>
          
          &copy; 2006 - 2018
          <a href="mailto:uwabami@gfd-dennou.org"></a>,
          Lastupdate: 2018-10-16 19:46:45
          <br />
          <span class="generator"> Powered by
            <a href="http://orgmode.org/" target="_blank" title="Org-mode">Org-mode</a>
            +
            <a href="http://jekyllrb.com/" target="_blank" title="Jekyll" >Jekyll</a>
            +
            <a href="http://nkmr6194.github.io/Umi/" target="_blank">Umi</a> &amp;
            <a href="http://getbootstrap.com/" target="_blank">Bootstrap</a>
          </span>
        </p>
      </div> <!-- /.col-sm-12 -->
    </div> <!-- /.row -->
  </div> <!-- /.container -->
</footer>
<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-90872419-1', 'auto');
  ga('send', 'pageview');
</script>

    <script src="/assets/js/org-toc.js"></script>
  </body>
</html>
